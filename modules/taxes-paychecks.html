<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Module 6: Taxes & Paychecks | Financially Sovereign Academy</title>
    <meta name="description" content="Understand your paycheck, maximize take-home pay, and navigate the tax system without getting ripped off.">
    <link rel="stylesheet" href="../css/fsa-theme.css">
    <link rel="stylesheet" href="../css/interactive-components.css">
    <style>
        main {
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }

        .module-header {
            text-align: center;
            margin-bottom: 3rem;
            padding: 2rem;
            background: var(--fsa-gradient-card);
            border: 3px solid var(--fsa-green);
            border-radius: var(--radius-xl);
        }

        .module-header h1 {
            font-size: var(--font-size-4xl);
            color: var(--fsa-green);
            margin-bottom: 1rem;
        }

        .section {
            margin-bottom: 4rem;
        }

        .section-title {
            font-size: var(--font-size-3xl);
            color: var(--fsa-green);
            margin-bottom: 1.5rem;
            border-bottom: 3px solid var(--fsa-border-medium);
            padding-bottom: 0.5rem;
        }

        .content-block {
            background: var(--fsa-bg-card);
            border: 2px solid var(--fsa-border-subtle);
            border-radius: var(--radius-lg);
            padding: 2rem;
            margin-bottom: 2rem;
            line-height: 1.8;
        }

        .content-block h3 {
            color: var(--fsa-green-light);
            font-size: var(--font-size-xl);
            margin-bottom: 1rem;
        }

        .calculator {
            background: var(--fsa-bg-secondary);
            border: 2px solid var(--fsa-border-medium);
            border-radius: var(--radius-xl);
            padding: 2rem;
            margin: 2rem 0;
        }

        .paycheck-breakdown {
            background: var(--fsa-bg-dark);
            border: 2px solid var(--fsa-border-medium);
            border-radius: var(--radius-lg);
            padding: 1.5rem;
            margin-top: 1.5rem;
        }

        .breakdown-row {
            display: flex;
            justify-content: space-between;
            padding: 0.75rem 0;
            border-bottom: 1px solid var(--fsa-border-subtle);
        }

        .breakdown-row.total {
            border-top: 3px solid var(--fsa-green);
            border-bottom: none;
            margin-top: 1rem;
            padding-top: 1rem;
            font-size: var(--font-size-xl);
            font-weight: var(--font-weight-bold);
            color: var(--fsa-green);
        }

        .breakdown-label {
            color: var(--fsa-text-secondary);
        }

        .breakdown-value {
            font-weight: var(--font-weight-semibold);
            font-family: var(--font-family-mono);
        }

        .scenario-container {
            background: var(--fsa-bg-card);
            border: 2px solid var(--fsa-border-medium);
            border-radius: var(--radius-lg);
            padding: 2rem;
            margin: 2rem 0;
        }

        .scenario-choices {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 1.5rem 0;
        }

        .scenario-outcome {
            background: var(--fsa-bg-dark);
            border: 2px solid var(--fsa-green);
            border-radius: var(--radius-lg);
            padding: 1.5rem;
            margin-top: 1.5rem;
        }

        .scenario-outcome.hidden {
            display: none;
        }

        .quiz {
            background: var(--fsa-bg-card);
            border: 2px solid var(--fsa-border-medium);
            border-radius: var(--radius-xl);
            padding: 2rem;
            margin: 2rem 0;
        }

        .quiz-question {
            font-size: var(--font-size-xl);
            color: var(--fsa-green);
            margin-bottom: 1.5rem;
        }

        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .quiz-option {
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid var(--fsa-border-medium);
            border-radius: var(--radius-md);
            padding: 1rem;
            cursor: pointer;
            transition: all var(--transition-base);
            color: var(--fsa-text-primary);
            text-align: left;
        }

        .quiz-option:hover {
            border-color: var(--fsa-green);
        }

        .quiz-option.correct {
            background: rgba(16, 185, 129, 0.2);
            border-color: var(--fsa-success);
        }

        .quiz-option.incorrect {
            background: rgba(239, 68, 68, 0.2);
            border-color: var(--fsa-error);
        }

        .quiz-feedback {
            margin-top: 1rem;
            padding: 1rem;
            border-radius: var(--radius-md);
        }

        .quiz-feedback.correct {
            background: rgba(16, 185, 129, 0.1);
            color: var(--fsa-success);
        }

        .quiz-feedback.incorrect {
            background: rgba(239, 68, 68, 0.1);
            color: var(--fsa-error);
        }

        .tax-brackets {
            background: var(--fsa-bg-dark);
            border: 2px solid var(--fsa-border-medium);
            border-radius: var(--radius-lg);
            padding: 1.5rem;
            margin: 1rem 0;
        }

        .bracket-row {
            display: flex;
            justify-content: space-between;
            padding: 0.5rem 0;
            border-bottom: 1px solid var(--fsa-border-subtle);
        }

        @media (max-width: 768px) {
            .scenario-choices {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Calculators Link -->
    <a href="../calculators/" style="position: fixed; top: 1.5rem; right: 1.5rem; color: #10b981; text-decoration: none; z-index: 10000; font-weight: 600; display: flex; align-items: center; gap: 0.5rem; background: rgba(26, 58, 46, 0.95); padding: 0.75rem 1.25rem; border-radius: 0.5rem; border: 2px solid rgba(16, 185, 129, 0.3); backdrop-filter: blur(10px); transition: all 0.3s ease; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);" onmouseover="this.style.borderColor='#10b981'; this.style.transform='translateY(-2px)'; this.style.boxShadow='0 8px 20px rgba(16, 185, 129, 0.4)';" onmouseout="this.style.borderColor='rgba(16, 185, 129, 0.3)'; this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 6px rgba(0, 0, 0, 0.3)';">
        <span style="font-size: 1.2rem;">üßÆ</span>
        <span>Calculators</span>
    </a>
    <main>
        <div class="module-header">
            <h1>Module 6: Taxes & Paychecks</h1>
            <p class="subtitle">Understand your paycheck and keep more of what you earn</p>
        </div>

        <section class="section">
            <h2 class="section-title">Where Your Paycheck Goes</h2>
            
            <div class="content-block">
                <h3>Gross Pay vs Net Pay</h3>
                <p><strong>Gross Pay:</strong> What your employer says you make (before anything is taken out)</p>
                <p><strong>Net Pay (Take-Home):</strong> What actually hits your bank account</p>
                <p>The difference? Taxes, benefits, and other deductions.</p>
            </div>

            <div class="content-block">
                <h3>What Gets Taken Out?</h3>
                <p><strong>Federal Income Tax:</strong> Goes to IRS. Progressive rates (10-37%)</p>
                <p><strong>State Income Tax:</strong> Varies by state (0-13%). Texas, Florida, Nevada have 0%</p>
                <p><strong>FICA (Social Security + Medicare):</strong> 7.65% total</p>
                <ul>
                    <li>Social Security: 6.2% (up to $168,600 in 2024)</li>
                    <li>Medicare: 1.45% (no limit)</li>
                </ul>
                <p><strong>Benefits:</strong> Health insurance, 401(k), etc. (voluntary but common)</p>
            </div>

            <div class="highlight highlight-warning">
                <strong>‚ö†Ô∏è Reality Check:</strong> If you make $60,000/year, you won't see $60,000. After taxes and deductions, you might take home $45,000. Plan accordingly.
            </div>
        </section>

        <section class="section">
            <h2 class="section-title">Paycheck Breakdown Calculator</h2>
            
            <div class="calculator">
                <h3 style="font-size: var(--font-size-2xl); color: var(--fsa-green); margin-bottom: 1.5rem; text-align: center;">See Where Your Money Goes</h3>
                
                <div class="form-group">
                    <label class="form-label" for="gross-salary">Annual Gross Salary</label>
                    <input type="number" id="gross-salary" class="form-input" placeholder="e.g., 60000" value="60000">
                </div>

                <div class="form-group">
                    <label class="form-label" for="state-tax">State Tax Rate (%)</label>
                    <input type="number" id="state-tax" class="form-input" placeholder="e.g., 5" value="5" step="0.1">
                    <span class="form-help">Enter 0 if you live in TX, FL, NV, WA, SD, WY, TN, NH, or AK</span>
                </div>

                <div class="form-group">
                    <label class="form-label" for="health-insurance">Monthly Health Insurance Premium</label>
                    <input type="number" id="health-insurance" class="form-input" placeholder="e.g., 150" value="150">
                </div>

                <div class="form-group">
                    <label class="form-label" for="retirement-pct">401(k) Contribution (%)</label>
                    <input type="number" id="retirement-pct" class="form-input" placeholder="e.g., 6" value="6" step="1">
                </div>

                <button class="btn btn-primary" onclick="calculatePaycheck()">Calculate Take-Home Pay</button>

                <div class="paycheck-breakdown hidden" id="paycheck-result">
                    <div class="breakdown-row">
                        <span class="breakdown-label">Annual Gross Salary</span>
                        <span class="breakdown-value" id="result-gross">$60,000</span>
                    </div>
                    <div class="breakdown-row">
                        <span class="breakdown-label">Federal Income Tax (est.)</span>
                        <span class="breakdown-value" id="result-federal">-$6,858</span>
                    </div>
                    <div class="breakdown-row">
                        <span class="breakdown-label">State Income Tax</span>
                        <span class="breakdown-value" id="result-state">-$3,000</span>
                    </div>
                    <div class="breakdown-row">
                        <span class="breakdown-label">Social Security (6.2%)</span>
                        <span class="breakdown-value" id="result-ss">-$3,720</span>
                    </div>
                    <div class="breakdown-row">
                        <span class="breakdown-label">Medicare (1.45%)</span>
                        <span class="breakdown-value" id="result-medicare">-$870</span>
                    </div>
                    <div class="breakdown-row">
                        <span class="breakdown-label">Health Insurance</span>
                        <span class="breakdown-value" id="result-health">-$1,800</span>
                    </div>
                    <div class="breakdown-row">
                        <span class="breakdown-label">401(k) Contribution</span>
                        <span class="breakdown-value" id="result-401k">-$3,600</span>
                    </div>
                    <div class="breakdown-row total">
                        <span class="breakdown-label">Annual Take-Home Pay</span>
                        <span class="breakdown-value" id="result-takehome">$40,152</span>
                    </div>
                    <div style="margin-top: 1rem; text-align: center; color: var(--fsa-text-secondary);">
                        <span id="result-monthly">Monthly: $3,346</span>
                    </div>
                </div>
            </div>
        </section>

        <section class="section">
            <h2 class="section-title">How Tax Brackets Really Work</h2>
            
            <div class="content-block">
                <h3>The Biggest Tax Myth</h3>
                <p><strong>Myth:</strong> "If I make $1 more and move into a higher tax bracket, I'll lose money!"</p>
                <p><strong>Reality:</strong> Only the dollars ABOVE the bracket threshold are taxed at the higher rate.</p>
                <p>Tax brackets are MARGINAL, not flat.</p>
            </div>

            <div class="content-block">
                <h3>2024 Federal Tax Brackets (Single Filer)</h3>
                <div class="tax-brackets">
                    <div class="bracket-row">
                        <span>$0 - $11,600</span>
                        <span>10%</span>
                    </div>
                    <div class="bracket-row">
                        <span>$11,601 - $47,150</span>
                        <span>12%</span>
                    </div>
                    <div class="bracket-row">
                        <span>$47,151 - $100,525</span>
                        <span>22%</span>
                    </div>
                    <div class="bracket-row">
                        <span>$100,526 - $191,950</span>
                        <span>24%</span>
                    </div>
                    <div class="bracket-row">
                        <span>$191,951 - $243,725</span>
                        <span>32%</span>
                    </div>
                    <div class="bracket-row">
                        <span>$243,726 - $609,350</span>
                        <span>35%</span>
                    </div>
                    <div class="bracket-row">
                        <span>$609,351+</span>
                        <span>37%</span>
                    </div>
                </div>
            </div>

            <div class="content-block">
                <h3>Example: $60,000 Salary</h3>
                <p>If you make $60,000, here's how you're taxed:</p>
                <ul>
                    <li>First $11,600 @ 10% = $1,160</li>
                    <li>Next $35,550 ($11,601-$47,150) @ 12% = $4,266</li>
                    <li>Next $12,850 ($47,151-$60,000) @ 22% = $2,827</li>
                </ul>
                <p><strong>Total federal tax: $8,253 (13.8% effective rate, not 22%)</strong></p>
            </div>

            <div class="highlight highlight-tip">
                <strong>üí° Key Insight:</strong> Your "tax bracket" is just the rate on your last dollar earned, not your entire income.
            </div>
        </section>

        <section class="section">
            <h2 class="section-title">W-4 Form: Getting Your Withholding Right</h2>
            
            <div class="content-block">
                <h3>What is a W-4?</h3>
                <p>Form you fill out when starting a job. Tells your employer how much tax to withhold from each paycheck.</p>
                <p><strong>Goal:</strong> Break even at tax time (not owe, not get huge refund)</p>
            </div>

            <div class="content-block">
                <h3>The Refund Trap</h3>
                <p>Many people celebrate big tax refunds. This is backwards.</p>
                <p><strong>A $3,000 refund means:</strong> You gave the government an interest-free loan of $250/month all year</p>
                <p><strong>Better approach:</strong> Adjust W-4 so you break even, keep that $250/month to pay off debt or invest</p>
            </div>

            <div class="content-block">
                <h3>When to Update Your W-4</h3>
                <ul>
                    <li>Got married or divorced</li>
                    <li>Had a child</li>
                    <li>Bought a house (mortgage interest deduction)</li>
                    <li>Started a side hustle (need to withhold more)</li>
                    <li>Got a big raise</li>
                    <li>Owed taxes or got huge refund last year</li>
                </ul>
            </div>

            <!-- Interactive Lab: Write-offs Reality Check -->
            <div style="margin: 2rem 0; padding: 1.5rem; background: rgba(245, 158, 11, 0.1); border: 2px solid #f59e0b; border-radius: 0.75rem;">
                <p style="color: #f59e0b; font-weight: 600; margin-bottom: 0.75rem;">üí° TikTok says "write it off!" ‚Äî but do you know what that actually means?</p>
                <button
                    onclick="PopupLabs.open('writeoffs-reality')"
                    style="background: linear-gradient(135deg, #f59e0b, #fbbf24); color: white; border: none; padding: 0.875rem 1.5rem; border-radius: 0.5rem; font-weight: 700; cursor: pointer; transition: all 0.2s ease; width: 100%;"
                    onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(245, 158, 11, 0.4)';"
                    onmouseout="this.style.transform=''; this.style.boxShadow='';">
                    Write-Offs Are Not Free Money ‚Üí
                </button>
                <p style="font-size: 0.85rem; color: #9ca3af; margin-top: 0.5rem; margin-bottom: 0;">Quick scenario showing the math of tax deductions vs credits</p>
            </div>
        </section>

        <section class="section">
            <h2 class="section-title">Common Paycheck Deductions: Worth It or Not?</h2>
            
            <div class="content-block">
                <h3>401(k) Contributions ‚úÖ WORTH IT</h3>
                <p><strong>Why:</strong> Tax-deferred growth + employer match is free money</p>
                <p><strong>How much:</strong> At minimum, contribute enough to get full employer match</p>
                <p><strong>Example:</strong> If employer matches 50% up to 6%, contribute 6%</p>
            </div>

            <div class="content-block">
                <h3>Health Insurance ‚úÖ USUALLY WORTH IT</h3>
                <p><strong>Why:</strong> Employer plans are cheaper than individual market</p>
                <p><strong>Warning:</strong> High-deductible plans can be traps if you get sick</p>
                <p><strong>Tip:</strong> Compare deductible vs premium. Healthy? High-deductible + HSA might save money</p>
            </div>

            <div class="content-block">
                <h3>Flexible Spending Account (FSA) ‚ö†Ô∏è BE CAREFUL</h3>
                <p><strong>Pro:</strong> Pre-tax money for medical expenses</p>
                <p><strong>Con:</strong> "Use it or lose it" - money disappears if not spent by year end</p>
                <p><strong>Tip:</strong> Only contribute what you KNOW you'll spend (glasses, prescriptions, etc.)</p>
            </div>

            <div class="content-block">
                <h3>Supplemental Life/Disability Insurance ‚ö†Ô∏è MAYBE</h3>
                <p><strong>Employer basic coverage:</strong> Usually free or cheap - take it</p>
                <p><strong>Supplemental coverage:</strong> Often overpriced. Shop outside employer first</p>
            </div>
        </section>

        <section class="section">
            <h2 class="section-title">Scenario: Tax Time Surprise</h2>
            
            <div class="scenario-container">
                <h3 style="color: var(--fsa-green); margin-bottom: 1rem;">You file your taxes and...</h3>
                <p>You're working two jobs and didn't adjust your W-4 at either one. Now it's April.</p>
                
                <div class="scenario-choices">
                    <button class="btn btn-secondary" onclick="showOutcome('owe')">You owe $2,500</button>
                    <button class="btn btn-secondary" onclick="showOutcome('refund')">You get a $3,000 refund</button>
                    <button class="btn btn-secondary" onclick="showOutcome('break-even')">You break even (owe $50)</button>
                </div>

                <div class="scenario-outcome hidden" id="outcome-owe">
                    <h4 style="color: var(--fsa-warning); margin-bottom: 1rem;">Outcome: Owe $2,500</h4>
                    <p><strong>What happened:</strong> Both jobs withheld as if they were your only income. Combined, you're in a higher bracket.</p>
                    <p><strong>The problem:</strong> Now you need $2,500 immediately or face penalties and interest.</p>
                    <p><strong>The fix:</strong> Fill out W-4 at both jobs. Use "Multiple Jobs Worksheet" or IRS withholding calculator.</p>
                    <p><strong>Lesson:</strong> Multiple income sources = adjust withholding proactively.</p>
                </div>

                <div class="scenario-outcome hidden" id="outcome-refund">
                    <h4 style="color: var(--fsa-success); margin-bottom: 1rem;">Outcome: $3,000 Refund</h4>
                    <p><strong>What happened:</strong> You over-withheld all year.</p>
                    <p><strong>The problem:</strong> You gave government an interest-free loan while you carried credit card debt at 20% APR.</p>
                    <p><strong>The math:</strong> $3,000 refund = $250/month you could have used to pay down debt, saving ~$300 in interest</p>
                    <p><strong>The fix:</strong> Adjust W-4 to increase allowances. Take home more per paycheck.</p>
                    <p><strong>Lesson:</strong> Big refund ‚â† good. Break even is the goal.</p>
                </div>

                <div class="scenario-outcome hidden" id="outcome-break-even">
                    <h4 style="color: var(--fsa-green); margin-bottom: 1rem;">Outcome: Break Even (owe $50)</h4>
                    <p><strong>What happened:</strong> You nailed your withholding. Minimal owe/refund.</p>
                    <p><strong>Why it's good:</strong> You had access to your money all year to pay debt, invest, or save</p>
                    <p><strong>The strategy:</strong> Used IRS withholding calculator mid-year, adjusted W-4 accordingly</p>
                    <p><strong>Lesson:</strong> This is the ideal outcome. You used your money efficiently all year instead of giving IRS an interest-free loan.</p>
                </div>
            </div>

            <!-- Interactive Lab: Capital Gains Basics -->
            <div style="margin: 2rem 0; padding: 1.5rem; background: rgba(16, 185, 129, 0.1); border: 2px solid #10b981; border-radius: 0.75rem;">
                <p style="color: #10b981; font-weight: 600; margin-bottom: 0.75rem;">üìà Beyond paychecks: What happens when you sell investments?</p>
                <button
                    onclick="PopupLabs.open('capital-gains-basics')"
                    style="background: linear-gradient(135deg, #10b981, #34d399); color: white; border: none; padding: 0.875rem 1.5rem; border-radius: 0.5rem; font-weight: 700; cursor: pointer; transition: all 0.2s ease; width: 100%;"
                    onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(16, 185, 129, 0.4)';"
                    onmouseout="this.style.transform=''; this.style.boxShadow='';">
                    Capital Gains in One Screen ‚Üí
                </button>
                <p style="font-size: 0.85rem; color: #9ca3af; margin-top: 0.5rem; margin-bottom: 0;">Short-term vs long-term, cost basis, and when taxes are triggered</p>
            </div>
        </section>

        <section class="section">
            <h2 class="section-title">Check Your Understanding</h2>
            
            <div class="quiz">
                <div class="quiz-question">1. What does it mean if you get a $3,000 tax refund?</div>
                <div class="quiz-options">
                    <button class="quiz-option" onclick="checkAnswer(1, 'a', false)">A) You're great at taxes</button>
                    <button class="quiz-option" onclick="checkAnswer(1, 'b', true)">B) You gave the government an interest-free loan</button>
                    <button class="quiz-option" onclick="checkAnswer(1, 'c', false)">C) You saved $3,000</button>
                </div>
                <div class="quiz-feedback hidden" id="feedback-1"></div>
            </div>

            <div class="quiz">
                <div class="quiz-question">2. How do tax brackets actually work?</div>
                <div class="quiz-options">
                    <button class="quiz-option" onclick="checkAnswer(2, 'a', false)">A) All income taxed at your highest bracket rate</button>
                    <button class="quiz-option" onclick="checkAnswer(2, 'b', true)">B) Only dollars above each threshold taxed at that bracket's rate</button>
                    <button class="quiz-option" onclick="checkAnswer(2, 'c', false)">C) You can lose money by earning more</button>
                </div>
                <div class="quiz-feedback hidden" id="feedback-2"></div>
            </div>

            <div class="quiz">
                <div class="quiz-question">3. What's the minimum you should contribute to a 401(k)?</div>
                <div class="quiz-options">
                    <button class="quiz-option" onclick="checkAnswer(3, 'a', true)">A) Enough to get the full employer match</button>
                    <button class="quiz-option" onclick="checkAnswer(3, 'b', false)">B) The IRS maximum ($23,000)</button>
                    <button class="quiz-option" onclick="checkAnswer(3, 'c', false)">C) Nothing until debt is paid off</button>
                </div>
                <div class="quiz-feedback hidden" id="feedback-3"></div>
            </div>
        </section>

        <section class="section">
            <div class="card" style="text-align: center;">
                <h3 class="card-title">Module 6 Complete! üéâ</h3>
                <p class="card-description">You now understand your paycheck and how to keep more of what you earn.</p>
                <div style="margin-top: 2rem;">
                    <button class="btn btn-primary" onclick="completeModule()">Mark Complete & Continue to Module 7</button>
                </div>
            </div>
        </section>
    </main>

    <script src="../js/module-progress.js"></script>
    <script src="../js/progress-manager.js"></script>
    <script>
        const progressManager = new FSAProgressManager();
        progressManager.init();
        progressManager.setModuleVisited(6);

        function calculatePaycheck() {
            const grossSalary = parseFloat(document.getElementById('gross-salary').value) || 0;
            const stateTaxRate = parseFloat(document.getElementById('state-tax').value) || 0;
            const healthInsurance = parseFloat(document.getElementById('health-insurance').value) || 0;
            const retirement401kPct = parseFloat(document.getElementById('retirement-pct').value) || 0;

            if (grossSalary === 0) {
                alert('Please enter your annual gross salary');
                return;
            }

            // Simplified federal tax calculation (progressive brackets)
            let federalTax = 0;
            const brackets = [
                { limit: 11600, rate: 0.10 },
                { limit: 47150, rate: 0.12 },
                { limit: 100525, rate: 0.22 },
                { limit: 191950, rate: 0.24 },
                { limit: 243725, rate: 0.32 },
                { limit: 609350, rate: 0.35 },
                { limit: Infinity, rate: 0.37 }
            ];

            let previousLimit = 0;
            for (let bracket of brackets) {
                if (grossSalary > previousLimit) {
                    const taxableInBracket = Math.min(grossSalary, bracket.limit) - previousLimit;
                    federalTax += taxableInBracket * bracket.rate;
                    previousLimit = bracket.limit;
                } else {
                    break;
                }
            }

            // Calculate other deductions
            const stateTax = grossSalary * (stateTaxRate / 100);
            const socialSecurity = Math.min(grossSalary, 168600) * 0.062;
            const medicare = grossSalary * 0.0145;
            const healthAnnual = healthInsurance * 12;
            const retirement401k = grossSalary * (retirement401kPct / 100);

            const totalDeductions = federalTax + stateTax + socialSecurity + medicare + healthAnnual + retirement401k;
            const takehome = grossSalary - totalDeductions;
            const monthlyTakehome = takehome / 12;

            // Display results
            document.getElementById('paycheck-result').classList.remove('hidden');
            document.getElementById('result-gross').textContent = `$${grossSalary.toLocaleString()}`;
            document.getElementById('result-federal').textContent = `-$${Math.round(federalTax).toLocaleString()}`;
            document.getElementById('result-state').textContent = `-$${Math.round(stateTax).toLocaleString()}`;
            document.getElementById('result-ss').textContent = `-$${Math.round(socialSecurity).toLocaleString()}`;
            document.getElementById('result-medicare').textContent = `-$${Math.round(medicare).toLocaleString()}`;
            document.getElementById('result-health').textContent = `-$${Math.round(healthAnnual).toLocaleString()}`;
            document.getElementById('result-401k').textContent = `-$${Math.round(retirement401k).toLocaleString()}`;
            document.getElementById('result-takehome').textContent = `$${Math.round(takehome).toLocaleString()}`;
            document.getElementById('result-monthly').textContent = `Monthly: $${Math.round(monthlyTakehome).toLocaleString()}`;
        }

        function showOutcome(outcome) {
            const outcomes = ['owe', 'refund', 'break-even'];
            outcomes.forEach(o => {
                document.getElementById(`outcome-${o}`).classList.add('hidden');
            });
            document.getElementById(`outcome-${outcome}`).classList.remove('hidden');
        }

        function checkAnswer(questionNum, answer, isCorrect) {
            const feedback = document.getElementById(`feedback-${questionNum}`);
            const options = feedback.parentElement.querySelectorAll('.quiz-option');
            
            options.forEach(opt => opt.style.pointerEvents = 'none');
            event.target.classList.add(isCorrect ? 'correct' : 'incorrect');
            
            feedback.classList.remove('hidden');
            feedback.classList.add(isCorrect ? 'correct' : 'incorrect');
            
            if (isCorrect) {
                feedback.textContent = '‚úì Correct!';
            } else {
                feedback.textContent = '‚úó Not quite. Review the content above.';
                setTimeout(() => {
                    options.forEach(opt => opt.style.pointerEvents = 'auto');
                    event.target.classList.remove('incorrect');
                    feedback.classList.add('hidden');
                }, 2000);
            }
        }

        function completeModule() {
            progressManager.setModuleComplete(6, { timeSpent: 0, score: 100 });
            alert('Module 6 complete! Next: Module 7 - Investing Fundamentals.');
            window.location.href = '../index.html';
        }
    </script>

    <!-- Interactive Popup Lab System -->
    <script src="../js/popups.js"></script>
</body>
</html>
